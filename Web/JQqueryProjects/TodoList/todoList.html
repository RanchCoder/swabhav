<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"
      integrity="sha512-5A8nwdMOWrSz20fDsjczgUidUBR8liPYU+WymTZP1lmY9G6Oc7HlZv156XqnsgNUzTyMefFTcsFH/tnJE/+xBg=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css">
    <title>TODO LIST</title>
  </head>
  <body>
    <section class="container">
        <div class="inputSection">

            <div>
                
            <label for="inputTodo">Enter Task</label>
                <input type="text" name="" id="inputTodo" />
            <button class="roundBtn" id="addBtn">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
            

            </div>
                 
            
        </div>
    </section>
    <section class="container" id="resultSection">
           <table class="tbl-todo">
               <thead>
                   <th>id</th>
                   <th>task</th>
                   <th>date & time</th>
               </th>
               <tbody id="tbody">
               
               </tbody>

           </table>
    </section>
  </body>
</html>

<script src="../jquery.js"></script>
<script>
    $(function(){
        if(isListInLocalStorage()){
            PresentTodoList(getListFromLocalStorage());
        }
        $("#addBtn").on('click',()=>{
        
            let listOfTodos;

            if(isListInLocalStorage()){
                // console.log("list is present");
                AddToList();
            }else{
                // console.log("list is absent");
                setLocalStorage();
                AddToList();
            }      
            

        })
    })

    function PresentTodoList(listOfTodos){
        listOfTodos.forEach(listItem => {
            console.log(listItem.name);
            $("#tbody").append(`<tr>
                         <td>${listItem.id}</td>
                         <td>${listItem.name}</td>
                         <td>${listItem.dateTime}</td>
                    </tr>`)
        });
       
    }


    function AddToList(){
        listOfTodos = getListFromLocalStorage();
                listOfTodos.push({"id":1,"name":getCurrentInputFromUser(),"dateTime":getLatestDateTime()});
            localStorage.setItem("todoList",JSON.stringify(listOfTodos));
            location.reload();
    }

    function isListInLocalStorage(){
        if(localStorage.getItem("todoList") !== null){
                 return true;
            }
            return false;
    }

    function setLocalStorage(){

        localStorage.setItem("todoList",JSON.stringify([]));

    }

    function getListFromLocalStorage(){
          return JSON.parse(localStorage.getItem("todoList"));
    }
    function isListObjectEmpty(listObject){
        if(listObject.length === 0){
            return true;
        }
        return false;

    }

    function getLatestDateTime(){
            let date = new Date();
            let currentDateTime = date.getDate() 
                                  + " / "
                                  + date.getMonth() 
                                  + " / " 
                                  + date.getFullYear() + " : "
                                  + date.getHours() + " : "
                                  + ((date.getMinutes() < 10) ? `0${date.getMinutes()}` : date.getMinutes())+ " "
                                  + ((date.getUTCHours() < 12) ? "am" : "pm");
            return currentDateTime;                      
    }
    function getCurrentInputFromUser(){
        return $("#inputTodo").val();
        
    }
</script>
